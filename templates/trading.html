<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading page</title>
    <script>
      function market_trading(){
        var marketCoin=prompt('구매하실 코인 개수를 입력하세요');
        if (marketCoin!==null){
          var form=document.createElement('form');
          form.method='POST';
          form.action='/market_trading/{{username}}';

          var input=document.createElement('input');
          input.type = 'hidden';
          input.name = 'market_trading';
          input.value = marketCoin; 
          // prompt에서 입력한 개수가 marketCoin으로 들어가고
          // 그게 input 값으로 들어가려면 input.value=marketCoin을 꼭 해줘야 함

          // 이 순서로 해야됨 (form에 input 넣고 그 form을 document에 넣기)
          form.appendChild(input); // 폼에 input 엘리먼트 추가
          document.body.appendChild(form); // 폼을 문서에 추가
          form.submit();
        }
      }
    </script>
  </head>
  <!--
    1. 마켓플레이스에서 하는 거래 내용
    ㄴ 그 전에 서버에 저장되어 있는 코인 마켓의 보유 코인을 보여줘야 함
    2. 유저 간의 거래 내용
    ㄴ 판매 게시물

    따로 섹션 나눠서 해야될 듯!
-->
  <body>
    <!-- 이걸 해야 flash가 뜸 -->
    {% with messages = get_flashed_messages() %}
        {% if messages %}
        <script>
            alert('{{ messages[0] }}');
        </script>
        {% endif %}
    {% endwith %}
    <!--
      화면의 반은 코인 마켓 section
      나머지 반은 판매 게시글 section

      코인 마켓 section에선
      위에 코인 마켓의 보유 코인
      밑에 구매하기 버튼

      판매 게시글 section에선
      위에 스크롤 되는 판매 게시글들 모음 (div로 하고 overflow 쓰자)
      ㄴ 그리고 판매 게시글 제목을 <a> 태그로 하고 클릭하면 게시글로 들어갈 수 있게 하자
      밑에 판매 게시글 작성 버튼
    -->
    <header class="page-header">
      <h1 class="h1_logo"><a href="{{ url_for('index') }}"><img class="logo" src="../static/images//binanceLogo.jpeg" alt="마켓 홈"></a></h1>
      <nav>
        <ul class="main-nav">
            <li><a href="{{ url_for('trading',username=username) }}">Trading</a></li>
            <li><a href="{{ url_for('login') }}">로그인해줘</a>
            <li><a href="{{ url_for('signup') }}">Sign up</a></li>
        </ul>
      </nav>
    </header>
    <main>
      <div class="coin_market">
        <h1>Coin Market</h1>
        <h2>Market Coin : {{market_coin}}</h2>
        <br><br>
        <!-- 거래하기 버튼.
        버튼 클릭하면 coin_trading 함수가 실행되고
        그 함수에서 coin_trading url로 이동 (flask)
        -->
        <button class="market_buy" onclick="market_trading()">구매 하기</button>
      </div>

      <div class="account_div">
        <h2>Account money : {{money.money}}</h2>
        <h2>Account coin : {{coin.coin}}</h2>
      </div>

      <div class="sale_post">
      </div>
    </main>
  </body>
</html>